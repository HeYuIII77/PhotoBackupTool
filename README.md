# 照片/视频备份工具

这是一个面向摄影与视频素材整理场景的备份工具，用于将指定源目录中的媒体文件，按文件类型自动分流备份到不同目标目录。

工具支持 JPEG / RAW / 视频多类型文件，支持并行复制、进度监控、日志记录，适合大规模素材备份与归档使用。

## 功能特点

- 📁 **递归扫描源目录**，自动识别媒体文件
  - JPEG / PNG
  - 多品牌 RAW 格式（用户可配置）
  - 多种视频格式（用户可配置）

- 🎯 **分类备份**
  - 支持为 JPEG / RAW / 视频分别设置目标目录
  - 支持保留源目录的文件夹结构（可选）

- 🔄 **重复文件处理策略**
  - 覆盖
  - 跳过
  - 自动重命名

- ⚡ **高性能并行复制**
  - 支持自定义并行度（最大并发复制数）
  - 基于磁盘路径的并行限流策略，减少同一磁盘写入争用
  - 支持大文件高性能异步复制（顺序读 + 大缓冲）

- 📊 **精细进度反馈**
  - 总体进度
  - 单文件进度
  - 当前文件名
  - 实时吞吐量（Bytes/s）
  - 已用时间 / 预计剩余时间

- ❌ **操作控制**
  - 支持中途取消操作
  - 提供完整异常与错误日志记录

## 界面说明

主界面包含以下功能区域：

### 1. 文件夹选择区域
- 源目录选择（支持递归扫描）
- JPEG 目标目录
- RAW 目标目录
- 视频目标目录（可选，未设置时回退到 JPEG 目录）

### 2. 格式选择区域
- RAW 文件格式选择（支持多品牌、多机型）
- 视频文件格式选择（常见视频封装格式）

### 3. 备份设置区域
- 重复文件处理策略选择（覆盖 / 跳过 / 自动重命名）
- 最大并行度设置（控制同时进行的文件复制数量）
- 操作日志与状态信息显示

### 4. 进度显示区域
- 总体进度条
- 当前任务状态提示
- 实时复制进度信息
- 开始备份 / 取消备份控制按钮

## 工作流程

1. 扫描源目录，递归获取所有符合条件的媒体文件
2. 统计文件总数与总体字节数
3. 预创建目标目录结构（避免并行复制时的目录竞态）
4. 按目标磁盘路径分组文件，限制单盘并发数
5. 启动异步并行复制任务
6. 按文件复制进度持续汇报状态
7. 完成或取消后输出最终结果

## 文件结构
PhotoBackupTool/
├── MainForm.cs                # 主窗体逻辑与 UI 交互    
├── MainForm.Designer.cs       # WinForms 界面定    
├── BackupManager.cs           # 核心备份与并行复制逻辑    
├── BackupSettings.cs          # 备份配置模型    
├── ErrorLogger.cs             # 错误与异常日志    
├── Program.cs                 # 程序入口    
├── PhotoBackupTool.csproj     # 项目文件    
└── README.md                  # 使用说明    


## 运行环境

- **操作系统**: Windows 7 / 8 / 10 / 11
- **运行时**: .NET Framework 4.x 或 .NET 6+
- **架构**: 大文件与多线程复制场景下，建议使用 64 位运行环境
- **文件系统**: 建议目标磁盘为 NTFS / exFAT

## 使用方法

1. 启动程序
2. 选择源目录
3. 分别设置 JPEG / RAW / 视频目标目录
4. 勾选需要处理的 RAW 与视频格式
5. 选择重复文件处理策略
6. 设置并行度
7. 点击「开始备份」
8. 通过进度区域与日志观察执行状态

## 并行度选择建议

| 场景 | 推荐并行度 | 说明 |
|------|------------|------|
| 单机械硬盘（HDD） | 1–2 | 避免频繁寻道 |
| 单 SSD / NVMe | 4–8 | 充分利用 SSD 性能 |
| 多磁盘或多目标路径 | 8–16 | 分布到不同磁盘 |
| 网络存储（NAS / SMB） | 4–8 | 取决于网络与 NAS 性能 |

⚠️ **注意**: 并行度过高可能导致性能下降或系统负载过高。

## 注意事项

- 请确保目标磁盘有充足空间
- 备份过程中避免强制关闭程序
- 网络路径请确保连接稳定
- 大规模备份前，建议先小批量测试配置